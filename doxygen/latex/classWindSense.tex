\hypertarget{classWindSense}{
\section{\-Wind\-Sense \-Class \-Reference}
\label{classWindSense}\index{\-Wind\-Sense@{\-Wind\-Sense}}
}
\subsection*{\-Data \-Structures}
\begin{DoxyCompactItemize}
\item 
struct {\bfseries \-G\-P\-G\-L\-L}
\begin{DoxyCompactList}\small\item\em \-G\-P\-S \-Data \-Struct \-Contains the \-G\-P\-S data from the airmar. \end{DoxyCompactList}\item 
struct {\bfseries \-G\-P\-V\-T\-G}
\item 
struct {\bfseries \-W\-I\-M\-W\-V}
\end{DoxyCompactItemize}
\subsection*{\-Public \-Member \-Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classWindSense_af664d8ea5db527206e64301455277929}{\-Wind\-Sense} ()
\item 
int \hyperlink{classWindSense_a41186075f501fbc3b9c691e215c4ec47}{debug} (\hyperlink{classHardwareSerial}{\-Hardware\-Serial} \&debug\-Port\-In)
\begin{DoxyCompactList}\small\item\em \-Stuff related purely to out wind sensor set-\/up. \end{DoxyCompactList}\item 
int \hyperlink{classWindSense_aa68e74aa80256710f68238196f4d5fd0}{debug\-Dump} (\hyperlink{classHardwareSerial}{\-Hardware\-Serial} \&debug\-Port\-In)
\begin{DoxyCompactList}\small\item\em \-Dumps a lot of info to the computers serial line. \end{DoxyCompactList}\item 
\hypertarget{classWindSense_ab7f27184b3f70ddabb19ebc299b7e79e}{
int \hyperlink{classWindSense_ab7f27184b3f70ddabb19ebc299b7e79e}{better\-Debug} (\hyperlink{classHardwareSerial}{\-Hardware\-Serial} \&debug\-Port\-In)}
\label{classWindSense_ab7f27184b3f70ddabb19ebc299b7e79e}

\begin{DoxyCompactList}\small\item\em \-Attempt to create a more brief debug output \-Uses the sprintf to generate a single string to be dealt with by the serial function, rather than having to call it all the time. \end{DoxyCompactList}\item 
int \hyperlink{classWindSense_aa85692bc66f9f6d635e81590a0782a45}{poll\-All\-Values} ()
\begin{DoxyCompactList}\small\item\em \-All of the functions visible to the user. \end{DoxyCompactList}\item 
\hypertarget{classWindSense_a622dd679c41dd169ff9ed4286c170fff}{
int {\bfseries poll\-Value} (char nmea)}
\label{classWindSense_a622dd679c41dd169ff9ed4286c170fff}

\item 
\hypertarget{classWindSense_aa65c5726c560c19369894c401e82c280}{
int {\bfseries attach} (\hyperlink{classHardwareSerial}{\-Hardware\-Serial} \&sensor\-Port)}
\label{classWindSense_aa65c5726c560c19369894c401e82c280}

\item 
\hypertarget{classWindSense_a4eb80a839c1856caac3f8303bb7362e6}{
int {\bfseries stupid\-Debug} ()}
\label{classWindSense_a4eb80a839c1856caac3f8303bb7362e6}

\end{DoxyCompactItemize}


\subsection{\-Detailed \-Description}


\-Definition at line 20 of file \-Wind\-Sense.\-h.



\subsection{\-Constructor \& \-Destructor \-Documentation}
\hypertarget{classWindSense_af664d8ea5db527206e64301455277929}{
\index{\-Wind\-Sense@{\-Wind\-Sense}!\-Wind\-Sense@{\-Wind\-Sense}}
\index{\-Wind\-Sense@{\-Wind\-Sense}!WindSense@{\-Wind\-Sense}}
\subsubsection[{\-Wind\-Sense}]{\setlength{\rightskip}{0pt plus 5cm}\-Wind\-Sense\-::\-Wind\-Sense (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}
\label{classWindSense_af664d8ea5db527206e64301455277929}
$<$ index for part\-Sentence

$<$ index for the array of strings 

\-Definition at line 3 of file \-Wind\-Sense.\-cpp.


\begin{DoxyCode}
                     {
    partCount = 0;        
    stringArrayIdx = 0;   
}
\end{DoxyCode}


\subsection{\-Member \-Function \-Documentation}
\hypertarget{classWindSense_a41186075f501fbc3b9c691e215c4ec47}{
\index{\-Wind\-Sense@{\-Wind\-Sense}!debug@{debug}}
\index{debug@{debug}!WindSense@{\-Wind\-Sense}}
\subsubsection[{debug}]{\setlength{\rightskip}{0pt plus 5cm}int \-Wind\-Sense\-::debug (
\begin{DoxyParamCaption}
\item[{{\bf \-Hardware\-Serial} \&}]{debug\-Port\-In}
\end{DoxyParamCaption}
)}}
\label{classWindSense_a41186075f501fbc3b9c691e215c4ec47}


\-Stuff related purely to out wind sensor set-\/up. 

\-Things like the initialization after instantiation of the object, and some debugging function stuff. \-Waits for \-N\-M\-E\-A, tells you everything

\-This function takes a serial port to use for debugging the functions and listens for an \-N\-M\-E\-A sentence. \-Then it runs through them with the validation, splitting and parsing functions. \-It spits out output the entire way.

\-For this function to work properly, it must be called within a loop. \-If this were the only line to be executed in the main loop, it would work as expected.

\-The \-Serial port given to this function must have already had the baud rate set 

\-Definition at line 22 of file \-A\-I\-R\-M\-A\-R\-Specific.\-cpp.


\begin{DoxyCode}
                                                {
    debugPort = &debugPortIn;

    while(senSerial->available()) {
        if (senSerial->available() > MAX_SERIAL_BUFFER) {
            senSerial->flush();
        } else if (grabChar(senSerial->read())) {
            //betterDebug(debugPortIn);
            debugDump(debugPortIn);
        }
    }

    return 1;
}
\end{DoxyCode}


\-Here is the call graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=346pt]{classWindSense_a41186075f501fbc3b9c691e215c4ec47_cgraph}
\end{center}
\end{figure}


\hypertarget{classWindSense_aa68e74aa80256710f68238196f4d5fd0}{
\index{\-Wind\-Sense@{\-Wind\-Sense}!debug\-Dump@{debug\-Dump}}
\index{debug\-Dump@{debug\-Dump}!WindSense@{\-Wind\-Sense}}
\subsubsection[{debug\-Dump}]{\setlength{\rightskip}{0pt plus 5cm}int \-Wind\-Sense\-::debug\-Dump (
\begin{DoxyParamCaption}
\item[{{\bf \-Hardware\-Serial} \&}]{debug\-Port\-In}
\end{DoxyParamCaption}
)}}
\label{classWindSense_aa68e74aa80256710f68238196f4d5fd0}


\-Dumps a lot of info to the computers serial line. 

\-Would have been incorporated directly into the debug function, but it just takes up too much space. \-In the event the flash image for the arduino becomes too large be sure to get rid of this function.

\-Resets the \-Internal \-N\-M\-E\-A \-Index counters 

\-Definition at line 46 of file \-A\-I\-R\-M\-A\-R\-Specific.\-cpp.


\begin{DoxyCode}
                                                    {
    HardwareSerial* debugPort = &debugPortIn;

    // Information about what is in the partSentence Buffer
    debugPort->println("NMEA Detected");
    debugPort->println(partSentence);
    debugPort->print("Valid?...");
    debugPort->println(validateInternalNMEA());

    // Separating the NMEA into sub-strings
    splitInternalNMEA();
    for (int i = 0; i < stringArrayIdx; i++) {
        debugPort->print("String ");
        debugPort->print(i);
        debugPort->print(" ");
        debugPort->println(stringArray[i]);
    }

    parseInternalNMEA(stringArray[0]);

    // Dump the degrees and minutes to see if it worked
    debugPort->print("The minutes lattitude are ");
    debugPort->println(GPS_GPGLL.minuteLatitude);
    debugPort->print("The degrees lattitude are ");
    debugPort->println(GPS_GPGLL.degreeLatitude);
    debugPort->print("Lattitude Direction is ");
    debugPort->println(GPS_GPGLL.latitudeDirection);

    debugPort->print("The minutes longitude are ");
    debugPort->println(GPS_GPGLL.minuteLongitude);
    debugPort->print("The degrees longitude are ");
    debugPort->println(GPS_GPGLL.degreeLongitude);
    debugPort->print("longitude Direction is ");
    debugPort->println(GPS_GPGLL.longitudeDirection);

    debugPort->print("Wind Speed is ");
    debugPort->println(WIND_WIMWV.windSpeed);
    debugPort->print("Units for the speed ");
    debugPort->println(WIND_WIMWV.windSpeedUnits);
    debugPort->print("The angle is ");
    debugPort->println(WIND_WIMWV.windAngle);
    debugPort->print("The reference for that angle ");
    debugPort->println(WIND_WIMWV.reference);

    debugPort->print("Speed over ground ");
    debugPort->println(SPEED_GPVTG.speedoverGround);
    debugPort->print("Units ");
    debugPort->println(SPEED_GPVTG.speedUnits);
    debugPort->print("Course over ground ");
    debugPort->println(SPEED_GPVTG.courseoverGround);
    debugPort->print("Units ");
    debugPort->println(SPEED_GPVTG.unitCourseMeasurement);

    resetInternalNMEA();
    return 1;
}
\end{DoxyCode}
\hypertarget{classWindSense_aa85692bc66f9f6d635e81590a0782a45}{
\index{\-Wind\-Sense@{\-Wind\-Sense}!poll\-All\-Values@{poll\-All\-Values}}
\index{poll\-All\-Values@{poll\-All\-Values}!WindSense@{\-Wind\-Sense}}
\subsubsection[{poll\-All\-Values}]{\setlength{\rightskip}{0pt plus 5cm}int \-Wind\-Sense\-::poll\-All\-Values (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}
\label{classWindSense_aa85692bc66f9f6d635e81590a0782a45}


\-All of the functions visible to the user. 

\hyperlink{PublicFunctions_8cpp_source}{\-Public\-Functions.\-cpp}

\-Created on\-: \-Dec 2, 2011 \-Author\-: allgood38 \-Wait until all the possible values from the wind sensor updated

\-Within the maximum amount of time, wait for enough serial data to parse all of the known values from the wind sensor.

\-After every valid sentence 

\-Definition at line 16 of file \-Public\-Functions.\-cpp.


\begin{DoxyCode}
                             {
    const int recentlyUpdatedTime = 500;
    int timeStart = millis() - 10;
    int timeElapsed = millis() - timeStart;

    bool GPGLL_Updated = false;
    bool WIMWV_Updated = false;
    bool GPVTG_Updated = false;
    bool successfullParse = false;

    char* lastUpdated = '\0';

    while (!GPGLL_Updated || !WIMWV_Updated || !GPVTG_Updated) {

        if (senSerial->available() > MAX_SERIAL_BUFFER) {
            senSerial->flush();
        } else if (senSerial->available() && grabChar(senSerial->read())) {
            successfullParse = !(bool)processInternalNMEA();
        }

        /* Check to see which structure was just updated
         */
        if (successfullParse) {
            if (GPS_GPGLL.lastUpdated > millis() - recentlyUpdatedTime) {
                GPGLL_Updated = true;
            } else if (WIND_WIMWV.lastUpdated > millis() - recentlyUpdatedTime)
       {
                WIMWV_Updated = true;
            } else if (SPEED_GPVTG.lastUpdated > millis() - recentlyUpdatedTime
      ) {
                GPVTG_Updated = true;
            }
            successfullParse = false;
        }

        /* Further Conditions on the loop,
         * if too much time has passed, abort */
        timeElapsed = millis() - timeStart;
        if (timeElapsed > MAX_POLL_TIME_MS) {
            return 1;
        }
    }

    return 0;
}
\end{DoxyCode}


\-The documentation for this class was generated from the following files\-:\begin{DoxyCompactItemize}
\item 
\-Wind\-Sense.\-h\item 
\-A\-I\-R\-M\-A\-R\-Specific.\-cpp\item 
\-Parse\-To\-Struct.\-cpp\item 
\-Public\-Functions.\-cpp\item 
\-Wind\-Sense.\-cpp\end{DoxyCompactItemize}
